(this["webpackJsonpconquest-of-hell-idle"]=this["webpackJsonpconquest-of-hell-idle"]||[]).push([[0],{172:function(e){e.exports=JSON.parse('{"name":"conquest-of-hell-idle","version":"0.2.0","private":true,"homepage":"/hell-conquest-idle/","dependencies":{"@material-ui/core":"^4.11.1","@material-ui/icons":"^4.9.1","@testing-library/jest-dom":"^5.11.4","@testing-library/react":"^11.1.0","@testing-library/user-event":"^12.1.10","cypress":"^6.1.0","decimal.js":"^10.2.1","md5":"^2.3.0","node-uuid":"^1.4.8","react":"^17.0.1","react-circular-progressbar":"^2.0.3","react-dom":"^17.0.1","react-hotkeys-hook":"^2.4.0","react-redux":"^7.2.2","react-router-dom":"^5.2.0","react-scripts":"4.0.1","react-three-fiber":"^5.3.3","redux":"^4.0.5","seedrandom":"^3.0.5","three":"^0.122.0","tween.js":"^16.6.0","web-vitals":"^0.2.4"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":["react-app","react-app/jest"]},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},180:function(e,t,n){},297:function(e,t,n){},302:function(e,t){},304:function(e,t){},315:function(e,t){},317:function(e,t){},344:function(e,t){},346:function(e,t){},347:function(e,t){},352:function(e,t){},354:function(e,t){},373:function(e,t){},385:function(e,t){},388:function(e,t){},402:function(e,t){},703:function(e){e.exports=JSON.parse('{"0.1.0":{"changes":["Initial version"]},"0.1.1":{"changes":["Increased default hit chance from 50% to 90%.","Increased latent power base gain formula from 5 * (level - 1) ^ 2 to 10 * (level - 1) ^ 2.","Changed base hp formula to 50 + (25 * level).","Changed base damage formula to 10 * level.","Accuracy now increases chance of getting a more damaging type of hit and Evasion reduces it.","Player can choose bonus traits as a reincarnation bonus instead of automatically getting all previous traits.","Added a summary section above the action log to easily keep track of player and enemy HP.","Encounter generation logic chooses fights against approximately equal level enemies more often."]},"0.1.2":{"changes":["The player starts with bonus points instead of earning them on the first reincarnation.","Fixed the bonus point calculation and starting traits on the reincarnation page.","Added a new demon: Tormented Dead which inflicts the pain it suffers back on their enemies."]},"0.2.0":{"changes":["Reimplemented many traits.","Added tactics, which allows demons to emphasize certain attributes and customize their fighting style.","Reduced timer duration for almost all actions","Combat actions which occur on the same round now print at the same time","Added several additional tooltips."]}}')},704:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n(0),c=n.n(a),r=n(12),s=n.n(r),o=(n(297),n(17)),l=(n(180),n(18)),u=n(5),d=(n(391),n(16)),m=n(58),h=n(59),b={bloodthirstyKnight:{name:"Bloodthirsty Knight",traits:["bloodrage"],enabled:!0,appearance:"bloodthirstyKnight",texture:"01_warrior.png",description:"A ruthless warrior who delighted in slaughtering whoever they encounter on the battlefield."},rapaciousHighwayman:{name:"Rapacious Highwayman",traits:["cupidity"],enabled:!1,appearance:"rapaciousHighwayman",texture:"02_hunter.png",description:"A thief who stole from whomever he could get away with, from wealthy merchants to starving vagrants."},condemnedSlasher:{name:"Condemned Slasher",traits:["sadisticJoy"],enabled:!0,appearance:"condemnedSlasher",texture:"03_rogue.png",description:"A madman who gained exquisite pleasure from seeing how many cuts could be made in a victim's body before they died."},crushingSnake:{name:"Crushing Snake",traits:["inescapableGrasp"],enabled:!0,appearance:"crushingSnake",texture:"06_snake_01.png",description:"A monstrous reptile which"},skitteringHorror:{name:"Skittering Horror",traits:["terrifyingSkitter"],enabled:!0,appearance:"skitteringHorror",texture:"10_spider.png",description:"A massive spider that enjoys stalking its prey, frightening it by the sickening skittering of it's arachnid legs."},deadlyHornet:{name:"Deadly Hornet",traits:["piercingStrike"],enabled:!0,appearance:"deadlyHornet",texture:"12_wasp.png",description:"An insect whose stinger is able to pierce even metal protection."},tormentedDead:{name:"Tormented Dead",traits:["sharedPain"],enabled:!0,appearance:"tormentedDead",texture:"29_zombie.png",description:"A human denied eternal rest and in agony from its ruined flesh."},wheezingApparition:{name:"Wheezing Apparition",traits:["exhaustingTouch"],enabled:!1,appearance:"wheezingApparition",texture:"128_sorrowsworn.png",description:"A soul of someone killed by strangulation, searching endlessly for victims upon which it can inflict the same fate."}};function g(e){if(!b[e])throw new Error("No creature with id ".concat(e," is defined"))}console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/hell-conquest-idle",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_DEBUG_MODE,typeof Object({NODE_ENV:"production",PUBLIC_URL:"/hell-conquest-idle",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_DEBUG_MODE);var j={manualSpeedup:{enabled:!1,multiplier:2},actionLog:{maxSize:Object({NODE_ENV:"production",PUBLIC_URL:"/hell-conquest-idle",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_MAX_ACTIONLOG_SIZE||20},encounters:{lesserEncounterChanceWeight:10,greaterEncounterChanceWeight:10,evenEncounterChanceWeight:80,lesserLevelScale:1,greaterLevelScale:1,chanceToIntimidateLesser:"player.powerLevel.minus(enemy.powerLevel).pow(2).times(10)",chanceToEscapeGreater:"player.powerLevel.gt(enemy.powerLevel) ? 100 : Decimal.max(enemy.powerLevel.minus(player.powerLevel), 1).pow(2).times(10)"},mechanics:{artifacts:{enabled:Object({NODE_ENV:"production",PUBLIC_URL:"/hell-conquest-idle",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_FEATURE_ARTIFACTS_ENABLED||!1},reincarnation:{bonusPointsForHighestLevel:2,latentPowerGainOnReincarnate:"player.powerLevel.pow(2).times(2)",latentPowerEffectScale:.01,traitPointCost:"Decimal.max(1, traitsOwned.times(2))"},xp:{gainedFromGreaterDemon:"enemy.powerLevel",gainedFromLesserDemon:"enemy.powerLevel",gainedFromOtherDemon:"enemy.powerLevel.times(5)"},levelToPowerEquation:"$level.eq(1) ? Decimal(0) : Decimal($level.minus(1).toNumber()).pow(2).times(5)",powerToLevelEquation:"Decimal(0).eq($powerPoints) ? Decimal(1) : Decimal.sqrt($powerPoints.div(5)).plus(1).floor()",maxLevel:100,combat:{randomEncounterChance:"player.powerLevel.div(10).floor().times(10)",determineHit:"roll >= target ? 'hit' : 'miss'",precision:{baseAttribute:"deceit",effectPerPoint:.1},resilience:{baseAttribute:"brutality",effectPerPoint:.1},evasion:{baseAttribute:"cunning",effectPerPoint:.1},power:{baseAttribute:"brutality",effectPerPoint:.1},traitRank:{baseAttribute:"madness",effectPerPoint:.05},fatigue:{evasionPenaltyPerPoint:2},hp:{base:25,pointsPerLevel:25,healingPerLevel:5,baseAttribute:"madness",effectPerPoint:.05},baseHitChance:90,baseDamage:"player.powerLevel.times(10)",attributeDamageModifier:.02,defaultMinimumDamageMultiplier:.5,defaultMedianDamageMultiplier:1,defaultMaximumDamageMultiplier:1.5,baseMinimumDamageWeight:5,baseMedianDamageWeight:90,baseMaximumDamageWeight:5}},debug:"true"===Object({NODE_ENV:"production",PUBLIC_URL:"/hell-conquest-idle",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_DEBUG_MODE};function p(){j.debug&&console.debug.apply(null,arguments)}var f=n(3),O={aggressive:{title:"Aggressive",description:"Your tactics emphasize overwhelming power and violence.",modifiers:{power_modifier:.5,precision_modifier:.25}},defensive:{title:"Defensive",description:"Your tactics emphasize caution and husbanding your strength.",modifiers:{resilience_modifier:.5,healing_modifier:1}},deceptive:{title:"Deceptive",description:"Your tactics emphasize disorientation and trickery.",modifiers:{evasion_modifier:.5,critical_hit_damage_modifier:.5}}},x={berserk:{name:"Berserk",icon:"./icons/icons-516.png",description:"",effects:{power_multiplier:1.2,evasion_multiplier:.9}},terrified:{name:"Terrified",icon:"icons/icons-130.png",effects:{skip_turn:!0},decays:!0},restrained:{name:"Restrained",icon:"icons/icons-1276.png",effects:{accuracy_modifier:.9},decays:!0}},v={bloodrage:{name:"Blood Rage",icon:"icons/icons-139.png",description:u.template("This demon's unquenchable thirst for blood causes it to gain ${rank} stacks of Berserk when an enemy has 50% or less health."),on_round_end:{conditions:{health_percentage:{target:"any_enemy",below:50}},effects:{add_statuses:{berserk:{target:"attacker",rank:"rank"}}}}},cupidity:{name:"Cupidity",icon:"icons/icons-2503.png",description:u.template("When this demon successfully Intimidates another demon, it gains a <span style='color: red'>${rank}%</span> chance to seize the intimidated demon's Artifacts as though it were killed."),on_intimidate:{conditions:{chance:"$rank"},effects:{steal_item_chance:{target:"enemies"}}}},exhaustingTouch:{name:"Strangulation",icon:"icons/icons-115.png",description:u.template("The demon's touch saps the strength from the victims limbs, reducing both Damage and Defense by <span>${rank.times(5)}%</span> for 1 round.")},inescapableGrasp:{name:"Inescapable Grasp",icon:"icons/icons-2221.png",description:u.template("You bind your victims when you strike, causing ${rank} levels of Restrained when you hit with an attack."),on_hitting:{conditions:{critical_hit:{chance:100}},effects:{add_statuses:{restrained:{target:"attacked",rank:"rank"}}},duration:{rounds:2}}},sadisticJoy:{name:"Sadistic Joy",icon:"icons/icons-852.png",description:u.template("The demon gains vile pleasure from the pain it inflicts, absorbing an additional ${rank.times(25)}% power from killing other demons."),on_kill:{effects:{power_gain_modifier:"rank.times(.25)"}}},piercingStrike:{name:"Piercing Strike",icon:"icons/icons-113.png",description:u.template("Your fierce attacks can punch right through even armor. Your <span style='color: lightgreen'>Precision</span> is increased by <span style='color: orangered'>${rank.times(25)}%</span>"),continuous:{effects:{precision_modifier:{target:"self",modifier:"rank.times(.1)"}}}},sharedPain:{name:"Shared Pain",icon:"icons/icons-146.png",description:u.template("You return the pain of injuries inflicted on you, reflecting <span style='color: orangered'>${rank.times(5).toFixed()}%</span> of the damage back."),on_taking_damage:{effects:{target:"attacker",damage:"$rank.times(5).div(100).times(attackDamage)"}}},terrifyingSkitter:{name:"Terrifying Skitter",icon:"icons/icons-2260.png",description:u.template("The sickening sound of your feet on the ground unnerves even other demons, making the enemy <span style='color: violet'>Terrified</span> for <span style='color: lightblue'>${rank.div(10).round(0, 0).plus(1).toFixed()}</span> round(s), stunning them."),on_combat_start:{effects:{add_statuses:{terrified:{target:"all_enemies",rank:"rank"}}},duration:{rounds:"$rank.div(10).round(0, 0).plus(1)"}}}};var y=function(){function e(t){Object(m.a)(this,e),this._isPc=t.isPc||t._isPc,this.id=t.id,this._name=t.name||t._name,this._absorbedPower=Object(f.Decimal)(t.absorbedPower||t._absorbedPower||0),this._latentPower=Object(f.Decimal)(t.latentPower||t._latentPower||0),this._attributes=new k(t.attributes||t._attributes,this),this._currentHp=Object(f.Decimal)(t._currentHp||this.maximumHp),this._combat=new w(t.combat||t._combat,this),this._traits=Object.keys(t.traits||t._traits).reduce((function(e,n){return e[n]=Object(f.Decimal)((t.traits||t._traits)[n]),e}),{}),this._appearance=t.appearance||t._appearance,this._modifiers=t.modifiers||t._modifiers||[],this._tactics=t.tactics||t._tactics||"defensive",this._statuses=t.statuses||t._statuses||{}}return Object(h.a)(e,[{key:"clearStatuses",value:function(){var e=this;Object.keys(this._statuses).forEach((function(t){return delete e._statuses[t]}))}},{key:"reincarnate",value:function(e,t){this._appearance=e,this._traits=t}},{key:"otherDemonIsGreaterDemon",value:function(e){var t=F(j.encounters.greaterLevelScale,{player:this,enemy:e});return e.powerLevel.gte(this.powerLevel.plus(t))}},{key:"otherDemonIsLesserDemon",value:function(e){var t=F(j.encounters.lesserLevelScale,{player:this,enemy:e});return e.powerLevel.lte(this.powerLevel.minus(t))}},{key:"gainPower",value:function(e){var t=this.latentPower.times(j.mechanics.reincarnation.latentPowerEffectScale).plus(1);return e=e.times(t).floor(),this.absorbedPower=this.absorbedPower.plus(e),e}},{key:"addModifier",value:function(e){this._modifiers.push(e)}},{key:"tactics",get:function(){return this._tactics},set:function(e){this._tactics=e}},{key:"statuses",get:function(){return this._statuses}},{key:"isPc",get:function(){return this._isPc}},{key:"name",get:function(){return this._name}},{key:"powerLevel",get:function(){return N(this._absorbedPower)}},{key:"currentHp",get:function(){return Object(f.Decimal)(this._currentHp)},set:function(e){this.maximumHp.lt(e)?this._currentHp=this.maximumHp:this._currentHp=e}},{key:"isAlive",get:function(){return Object(f.Decimal)(this.currentHp).gt(0)}},{key:"latentPower",get:function(){return this._latentPower},set:function(e){this._latentPower=e}},{key:"maximumHp",get:function(){var e=this.attributes.madness.times(j.mechanics.combat.hp.effectPerPoint);return this.powerLevel.times(e.plus(1)).mul(j.mechanics.combat.hp.pointsPerLevel).floor()}},{key:"attributes",get:function(){return this._attributes}},{key:"combat",get:function(){return this._combat}},{key:"traits",get:function(){return this._traits},set:function(e){this._traits=e}},{key:"appearance",get:function(){return this._appearance}},{key:"healing",get:function(){var e=Object(f.Decimal)(this.powerLevel.times(j.mechanics.combat.hp.healingPerLevel)),t=Object(f.Decimal)(1).plus(O[this.tactics].modifiers.healing_modifier||0);return e.times(t)}},{key:"absorbedPower",get:function(){return this._absorbedPower},set:function(e){var t=this;this._absorbedPower=e,N(this._absorbedPower).gt(j.mechanics.maxLevel)&&(this._absorbedPower=R(j.mechanics.maxLevel)),this.appearance&&b[this.appearance].traits.forEach((function(e){t._traits[e]=N(t._absorbedPower).div(10).ceil(),E().unlockedTraits[e]=N(t._absorbedPower).div(10).ceil()}))}},{key:"speed",get:function(){return Object(f.Decimal)(100)}},{key:"modifiers",get:function(){return this._modifiers}}]),e}(),k=function(){function e(t,n){Object(m.a)(this,e),this._brutality=t.brutality||t._brutality||0,this._cunning=t.cunning||t._cunning||0,this._deceit=t.deceit||t._deceit||0,this._madness=t.madness||t._madness||0,Object.defineProperty(this,"character",{value:function(){return n}})}return Object(h.a)(e,[{key:"brutality",get:function(){var e=this.character().latentPower.times(j.mechanics.reincarnation.latentPowerEffectScale).plus(1);return Object(f.Decimal)(this._brutality).times(e).floor()}},{key:"cunning",get:function(){var e=this.character().latentPower.times(j.mechanics.reincarnation.latentPowerEffectScale).plus(1);return Object(f.Decimal)(this._cunning).times(e).floor()}},{key:"deceit",get:function(){var e=this.character().latentPower.times(j.mechanics.reincarnation.latentPowerEffectScale).plus(1);return Object(f.Decimal)(this._deceit).times(e).floor()}},{key:"madness",get:function(){var e=this.character().latentPower.times(j.mechanics.reincarnation.latentPowerEffectScale).plus(1);return Object(f.Decimal)(this._madness).times(e).floor()}}]),e}(),w=function(){function e(t,n){Object(m.a)(this,e),this.character=function(){return n}}return Object(h.a)(e,[{key:"minimumDamage",get:function(){return D(j.mechanics.combat.defaultMinimumDamageMultiplier,this.character()).floor()}},{key:"medianDamage",get:function(){return D(j.mechanics.combat.defaultMedianDamageMultiplier,this.character()).floor()}},{key:"maximumDamage",get:function(){var e=Object(f.Decimal)(1).plus(O[this.character().tactics].modifiers.critical_hit_damage_modifier||0);return D(Object(f.Decimal)(j.mechanics.combat.defaultMaximumDamageMultiplier),this.character()).times(e).floor()}},{key:"evasion",get:function(){var e=this,t=this.character().attributes[j.mechanics.combat.evasion.baseAttribute],n=Object(f.Decimal)(0).plus(O[this.character().tactics].evasion_modifier||0),i=Object.keys(this.character().statuses).reduce((function(e,t){var n=x[t];return e.plus(n.effects.evasion_multiplier||0).minus(1)}),Object(f.Decimal)(0)),a=Object.keys(this.character().traits).reduce((function(t,n){var i=v[n];return"self"===u.get(i,["continuous","effects","evasion_modifier","target"])?t.plus(F(u.get(i,["continuous","effects","evasion_modifier","modifier"]),{rank:Object(f.Decimal)(e.character().traits[n])})):t}),Object(f.Decimal)(0));return t.times(n.plus(i).plus(a).plus(1))}},{key:"precision",get:function(){var e=this,t=this.character().attributes[j.mechanics.combat.precision.baseAttribute],n=Object(f.Decimal)(0).plus(O[this.character().tactics].precison_modifier||0),i=Object.keys(this.character().statuses).reduce((function(e,t){var n=x[t];return e.plus(n.effects.precision_multiplier||0).minus(1)}),Object(f.Decimal)(0)),a=Object.keys(this.character().traits).reduce((function(t,n){var i=v[n];return"self"===u.get(i,["continuous","effects","precision_modifier","target"])?t.plus(F(u.get(i,["continuous","effects","precision_modifier","modifier"]),{rank:Object(f.Decimal)(e.character().traits[n])})):t}),Object(f.Decimal)(0));return t.times(n.plus(i).plus(a).plus(1))}},{key:"resilience",get:function(){var e=this,t=this.character().attributes[j.mechanics.combat.resilience.baseAttribute],n=Object(f.Decimal)(0).plus(O[this.character().tactics].resilience_modifier||0),i=Object.keys(this.character().statuses).reduce((function(e,t){var n=x[t];return e.plus(n.effects.resilience_multiplier||0).minus(1)}),Object(f.Decimal)(0)),a=Object.keys(this.character().traits).reduce((function(t,n){var i=v[n];return"self"===u.get(i,["continuous","effects","resilience_modifier","target"])?t.plus(F(u.get(i,["continuous","effects","resilience_modifier","modifier"]),{rank:Object(f.Decimal)(e.character().traits[n])})):t}),Object(f.Decimal)(0));return t.times(n.plus(i).plus(a).plus(1))}},{key:"power",get:function(){var e=this,t=this.character().attributes[j.mechanics.combat.power.baseAttribute],n=Object(f.Decimal)(0).plus(O[this.character().tactics].power_modifier||0),i=Object.keys(this.character().statuses).reduce((function(e,t){var n=x[t];return e.plus(n.effects.power_multiplier||0).minus(1)}),Object(f.Decimal)(0)),a=Object.keys(this.character().traits).reduce((function(t,n){var i=v[n];return"self"===u.get(i,["continuous","effects","power_modifier","target"])?t.plus(F(u.get(i,["continuous","effects","power_modifier","modifier"]),{rank:Object(f.Decimal)(e.character().traits[n])})):t}),Object(f.Decimal)(0));return t.times(n.plus(i).plus(a).plus(1))}}]),e}();function D(e,t){return F(j.mechanics.combat.baseDamage,{player:t}).times(e).ceil()}var _=n(172),S=n(392)("hell-conquest-".concat(_.version)),P={},A=L();function E(){return A}function T(){window.localStorage.setItem(S,JSON.stringify(A))}function L(e){var t=window.localStorage.getItem(S);return t?JSON.parse(t,I):{debug:{creatures:{},regions:{}},reincarnationCount:0,passivePowerIncome:Object(f.Decimal)(0),unlockedMonsters:{},unlockedTraits:{},paused:!0,currentAction:null,nextAction:null,id:0,highestLevelReached:Object(f.Decimal)(1),startingTraits:{},currentEncounter:null,manualSpeedMultiplier:j.manualSpeedup.enabled?j.manualSpeedup.multiplier:1,currentRegion:"forest",actionLog:[],exploration:{explorationTime:5e3,approachTime:5e3,combatTime:5e3,lootingTime:5e3,recoveryTime:2e3,fleeingTime:5e3,intimidateTime:5e3,reincarnationTime:1},characters:{0:new y({id:0,isPc:!0,name:"You",powerLevel:Object(f.Decimal)(1),absorbedPower:Object(f.Decimal)(0),appearance:"",statuses:{},traits:{},tactics:"defensive",items:[],attributes:{brutality:Object(f.Decimal)(0),cunning:Object(f.Decimal)(0),deceit:Object(f.Decimal)(0),madness:Object(f.Decimal)(0)},combat:{fatigue:0,minimumDamageMultiplier:.5,medianDamageMultiplier:1,maximumDamageMultiplier:1.5}})},tutorials:{}}}function C(e){return function(e){if(!A.characters[e])throw new Error("No creature exists for '".concat(e,"'"))}(e),A.characters[e]}var H=1;function M(e){return g(e),"monsters/".concat(b[e].texture)}function F(e,t){return null===e||void 0===e?e:(P[e]||(P[e]=new Function("context","with(context) {return ".concat(e,"}"))),t.Decimal=f.Decimal,t.config=j,P[e].call(null,t))}function R(e){return F(j.mechanics.levelToPowerEquation,{$level:Object(f.Decimal)(e)})}function N(e){return F(j.mechanics.powerToLevelEquation,{$powerPoints:Object(f.Decimal)(e)})}function I(e,t){switch(e){case"characters":return Object.keys(t).reduce((function(e,n){return e[n]=new y(t[n]),e}),{});case"enemies":return Object.keys(t).map((function(e){return new y(t[e])}));case"paused":return!1;case"passivePowerIncome":return Object(f.Decimal)(t);case"value":var n=Number.parseFloat(t);return Number.isNaN(n)?t:Object(f.Decimal)(t);default:return t}}var W=function(){function e(t,n,i,a){Object(m.a)(this,e),this.name=t,this.encounters=i,this.background=a}return Object(h.a)(e,[{key:"startEncounter",value:function(e,t){var n,i=j.encounters.lesserEncounterChanceWeight+j.encounters.greaterLevelScale+j.encounters.evenEncounterChanceWeight,a=Math.floor(t.double()*i)+1,c=j.encounters.lesserEncounterChanceWeight,r=j.encounters.lesserEncounterChanceWeight+j.encounters.evenEncounterChanceWeight;p("Determine encounter. Roll ".concat(a," vs lesser (<=").concat(c,"), even (<=").concat(r,")")),a<=j.encounters.lesserEncounterChanceWeight?(n="lesser",p("Lesser triggered")):a<=j.encounters.lesserEncounterChanceWeight+j.encounters.evenEncounterChanceWeight?(n="even",p("Even level encounter triggered")):(n="greater",p("Greater encounter triggered"));var s=e.powerLevel;switch(n){case"greater":var o=Math.floor(t.double()*j.encounters.greaterLevelScale);s=s.plus(o);break;case"lesser":var l=Math.floor(t.double()*j.encounters.lesserLevelScale);s=f.Decimal.max(1,s.minus(l));break;case"even":var m=Math.max(j.encounters.greaterLevelScale,j.encounters.lesserLevelScale)-Math.min(j.encounters.greaterLevelScale,j.encounters.lesserLevelScale),h=Math.floor(t.double()*m)-m;s=f.Decimal.max(1,s.plus(h))}j.debug&&p("Generated encounter level is ".concat(s));var x=function(e){var t=Object.keys(e.encounters).filter((function(t){p("Determining if '".concat(t,"' is enabled."));var n=!1!==e.encounters[t].enabled;n||p("Encounter '".concat(t,"' disabled"));var i=!1!==u.get(E(),["debug","regions",e.id,"encounters",t]);return i||p("Encounter '".concat(t,"' disabled by debug.")),n&&i})),n=t[Math.floor(Math.random()*Object.keys(t).length)];return p("Selected encounter '".concat(n,"'")),e.encounters[n]}(this);if(void 0===x)throw new Error("No encounter selected");return Object(d.a)(Object(d.a)({encounterLevel:s},x),{},{pendingActions:[],enemies:x.enemies.flatMap((function(e){return u.range(0,e.count).map((function(n){return function(e,t,n){if(g(e),j.debug&&p("Generating creature with id ".concat(e," and level ").concat(t)),void 0===t)throw new Error("No powerLevel");if(Number.isNaN(t))throw new Error("Level cannot be NaN");var i=Object.keys(O)[Math.floor(3*n.double())],a=H++;return A.characters[a]=new y(Object(d.a)(Object(d.a)({id:a},b[e]),{},{latentPower:Object(f.Decimal)(F(j.mechanics.reincarnation.latentPowerGainOnReincarnate,{player:{powerLevel:t.minus(1)}})).times(5),tactics:i,traits:b[e].traits.reduce((function(e,n){return e[n]=t.div(10).ceil(),e}),{}),absorbedPower:R(t),artifacts:[],statuses:[],attributes:{brutality:t.div(2).floor(),cunning:t.div(2).floor(),deceit:t.div(2).floor(),madness:t.div(2).floor()},combat:{fatigue:0,minimumDamageMultiplier:.5,medianDamageMultiplier:1,maximumDamageMultiplier:1.5}})),T(),A.characters[a]}(e.name,s,t)}))}))})}}]),e}(),q={forest:new W("The Prey's Lament",!0,{bloodthirstyKnight:{description:"1 Bloodthirsty Knight",type:"combat",enemies:[{name:"bloodthirstyKnight",count:1}]},rapaciousHighwayman:{description:"1 Rapacious Highwayman",type:"combat",enabled:!1,enemies:[{name:"rapaciousHighwayman",count:1}]},condemnedSlasher:{description:"1 Condemned Slasher",type:"combat",enabled:!0,enemies:[{name:"condemnedSlasher",count:1}]},crushingSnake:{description:"1 Crushing Snake",type:"combat",enabled:!0,enemies:[{name:"crushingSnake",count:1}]},skitteringHorror:{description:"1 Skittering Horror",type:"combat",enabled:!0,enemies:[{name:"skitteringHorror",count:1}]},deadlyHornet:{description:"1 Deadly Hornet",type:"combat",enabled:!0,enemies:[{name:"deadlyHornet",count:1}]},tormentedDead:{description:"1 Tormented Dead",type:"combat",enabled:!0,enemies:[{name:"tormentedDead",count:1}]}},{background:"backgrounds/parallax-demon-woods-bg.png",far:"backgrounds/parallax-demon-woods-far-trees.png",mid:"backgrounds/parallax-demon-woods-mid-trees.png",close:"backgrounds/parallax-demon-woods-close-trees.png"}),caves:new W("The Bottomless Caverns",!1,{},{}),mountains:new W("The Crags of Futility",!1,{},{}),desert:new W("The Desert of Isolation",!1,{},{})};var B={exploring:{id:"exploring",duration:"exploration.explorationTime",description:"Exploring..."},approaching:{id:"approaching",duration:"exploration.approachTime",description:"Approaching Enemy..."},dead:{id:"dead",duration:1e8,description:"Rotting, time to reincarnate..."},looting:{id:"looting",duration:"exploration.lootingTime",description:"Looting the body..."},fleeing:{id:"fleeing",duration:"exploration.fleeingTime",description:"Fleeing in terror!"},fighting:{id:"fighting",duration:"exploration.combatTime",description:"In Combat!"},reincarnating:{id:"resurrecting",duration:"exploration.reincarnationTime",description:"Reincarnating..."},recovering:{id:"recovering",duration:"exploration.recoveryTime",description:"Healing..."},intimidating:{id:"intimidating",duration:"exploration.intimidateTime",description:"Intimidating..."}},G=n(276),Y=n(740),$=n(37),K=n(732),U=n(739),z=n(281),J=n.n(z),V=n(282),X=n.n(V),Z=n(742),Q={brutality:{label:"Brutality",description:u.template("Brutality is how savage and ruthless a Demon is. It adds to Power and Resilience."),icon:"icons/icons-92.png"},cunning:{label:"Cunning",description:u.template("Cunning is how quick thinking a Demon is. It adds to Evasion."),icon:"icons/icons-24.png"},deceit:{label:"Deceit",description:u.template("Deceit is how underhanded and manipulative a Demon is. It adds to Precision."),icon:"icons/icons-17.png"},madness:{label:"Madness",description:u.template("Madness is how disconnected from the limits of reality the Demon is. It gives a ${rank * ".concat(100*j.mechanics.combat.traitRank.effectPerPoint,"}% bonus to the effects of Traits and health.")),icon:"icons/icons-124.png"}},ee=function(e){return Object(i.jsx)(K.a,{container:!0,children:Object(i.jsxs)("ul",{children:[O[e.tactic].modifiers.power_modifier&&Object(i.jsx)(Z.a,{title:"Power makes your hits deal additional damage.",children:Object(i.jsxs)("li",{style:{color:"green",textAlign:"left"},children:["+",100*O[e.tactic].modifiers.power_modifier,"% to Power"]})}),O[e.tactic].modifiers.precision_modifier&&Object(i.jsx)(Z.a,{title:"Precision makes your hits more severe.",children:Object(i.jsxs)("li",{style:{color:"green",textAlign:"left"},children:["+",100*O[e.tactic].modifiers.precision_modifier,"% to Precision"]})}),O[e.tactic].modifiers.resilience_modifier&&Object(i.jsx)(Z.a,{title:"Resilience makes you more resistant to damage.",children:Object(i.jsxs)("li",{style:{color:"green",textAlign:"left"},children:["+",100*O[e.tactic].modifiers.resilience_modifier,"% to Resilience"]})}),O[e.tactic].modifiers.healing_modifier&&Object(i.jsx)(Z.a,{title:"Healing increases how quickly you recover from injury.",children:Object(i.jsxs)("li",{style:{color:"green",textAlign:"left"},children:["+",100*O[e.tactic].modifiers.healing_modifier,"% to Healing"]})}),O[e.tactic].modifiers.evasion_modifier&&Object(i.jsx)(Z.a,{title:"Evasion makes incoming attacks less severe.",children:Object(i.jsxs)("li",{style:{color:"green",textAlign:"left"},children:["+",100*O[e.tactic].modifiers.evasion_modifier,"% to Evasion"]})}),O[e.tactic].modifiers.critical_hit_damage_modifier&&Object(i.jsx)(Z.a,{title:"Critical hits deal extra damage",children:Object(i.jsxs)("li",{style:{color:"green",textAlign:"left"},children:[100*O[e.tactic].modifiers.critical_hit_damage_modifier,"% to Critical hit damage"]})})]})})};function te(e){var t=Object(Y.d)(),n=C(0),c=Object(a.useState)(Object.keys(n.attributes).reduce((function(e,t){return e[t.substring(1)]=n.attributes[t],e}),{})),r=Object(o.a)(c,2),s=r[0],l=r[1],m=Object(a.useState)(C(0).tactics),h=Object(o.a)(m,2),g=(h[0],h[1]),p=Object(a.useState)(E().startingTraits),x=Object(o.a)(p,2),y=x[0],k=x[1],w=C(0).latentPower.plus(F(j.mechanics.reincarnation.latentPowerGainOnReincarnate,{player:n})),D=Object(f.Decimal)(E().highestLevelReached).times(j.mechanics.reincarnation.bonusPointsForHighestLevel).minus(Object.values(s).reduce((function(e,t){return Object(f.Decimal)(e).plus(t)}))).minus(Object.values(y).filter((function(e){return e})).reduce((function(e,t,n){return e.plus(F(j.mechanics.reincarnation.traitPointCost,{traitsOwned:Object(f.Decimal)(n)}))}),Object(f.Decimal)(0))),_=F(j.mechanics.reincarnation.traitPointCost,{traitsOwned:Object(f.Decimal)(Object.values(y).filter((function(e){return e})).length)});return Object(a.useEffect)((function(){E().paused=!0}),[]),Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(i.jsx)("strong",{children:"Reincarnate"})}),Object(i.jsxs)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:["Select a soul to reincarnate as.",Object(i.jsx)("br",{}),"You will reincarnate with a ",Object(i.jsxs)("strong",{children:[w.toFixed(),"%"]})," bonus to Attributes and absorbed power due to your Latent Power acquired from previous reincarnations.",Object(i.jsx)("br",{})]}),Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsxs)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:[Object(i.jsxs)("strong",{children:["Spend ",D.toFixed()," ",n.powerLevel.gt(1)?"points":"point"," on bonuses "]})," (Reach higher levels to gain more points)"]}),Object(i.jsx)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(i.jsx)("strong",{children:"Attributes"})}),Object.keys(Q).map((function(e){return Object(i.jsx)(K.a,{item:!0,xs:3,children:Object(i.jsx)(Z.a,{title:Q[e].description({rank:Object(f.Decimal)(s[e]).toFixed()}),children:Object(i.jsxs)("div",{style:{textAlign:"center"},children:[Object(i.jsx)("img",{src:Q[e].icon}),Object(i.jsxs)("div",{children:[Object(i.jsx)(U.a,{disabled:D.lte(0),onClick:function(){l(Object(d.a)(Object(d.a)({},s),{},Object($.a)({},e,Object(f.Decimal)(s[e]).plus(1))))},children:Object(i.jsx)(J.a,{})}),Object(f.Decimal)(s[e]).toFixed(),Object(i.jsx)(U.a,{disabled:Object(f.Decimal)(s[e]).lte(0),onClick:function(){l(Object(d.a)(Object(d.a)({},s),{},Object($.a)({},e,Object(f.Decimal)(s[e]).minus(1))))},children:Object(i.jsx)(X.a,{})})]})]})})})})),Object.keys(E().unlockedTraits).length>0&&Object(i.jsxs)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:[Object(i.jsx)("strong",{children:"Bonus Starting Traits"})," (Start with traits in addition to that innate to your new demon form)"]}),Object.keys(E().unlockedTraits).map((function(e){return Object(i.jsx)(K.a,{item:!0,container:!0,xs:3,justify:"space-around",style:{height:"138px"},children:Object(i.jsx)(K.a,{item:!0,xs:12,style:{textAlign:"center",height:"64%"},children:Object(i.jsx)(U.a,{variant:"contained",color:E().startingTraits[e]?"secondary":"default",disabled:D.lt(_)&&!y[e],onClick:function(){E().startingTraits[e]=!E().startingTraits[e],k(Object(d.a)({},E().startingTraits))},children:Object(i.jsx)(Z.a,{title:Object(i.jsx)("div",{dangerouslySetInnerHTML:{__html:"Rank ".concat(Object(f.Decimal)(E().unlockedTraits[e]).toFixed(),": ").concat(v[e].description({rank:Object(f.Decimal)(E().unlockedTraits[e])}))}}),children:Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsx)("img",{src:v[e].icon})}),Object(i.jsxs)(K.a,{item:!0,xs:12,children:[v[e].name," ",Object(f.Decimal)(E().unlockedTraits[e]).toFixed()]}),Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsxs)("em",{style:{visibility:y[e]?"hidden":"visible"},children:[_.toFixed()," pts"]})})]})})})})})}))]}),Object(i.jsxs)(K.a,{container:!0,item:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(i.jsx)(Z.a,{title:"Tactics provide modifiers based on your fighting style",children:Object(i.jsx)("strong",{children:"Choose Tactics"})})}),Object(i.jsx)(K.a,{container:!0,item:!0,xs:12,justify:"space-around",direction:"row",children:Object.keys(O).map((function(e){return Object(i.jsx)(K.a,{item:!0,children:Object(i.jsx)(U.a,{variant:"contained",onClick:function(){g(C(0).tactics=e)},color:n.tactics===e?"primary":"default",children:O[e].title})})}))}),Object(i.jsx)(K.a,{item:!0,style:{textAlign:"center"},children:Object(i.jsx)("em",{children:O[n.tactics].description})}),Object(i.jsx)(ee,{tactic:n.tactics})]}),Object(i.jsxs)(K.a,{container:!0,item:!0,xs:12,alignItems:"stretch",justify:"flex-start",children:[Object(i.jsx)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(i.jsx)("strong",{children:"Choose a demon to reincarnate as."})}),Object.keys(b).filter((function(e){var t=!1!==b[e].enabled,n=u.get(E(),["debug","creatures",e,"enabled"],!0);return t&&n})).map((function(n){return E().unlockedMonsters[n]?Object(i.jsx)(K.a,{container:!0,xs:3,justify:"space-around",children:Object(i.jsx)(K.a,{item:!0,xs:12,style:{textAlign:"center",height:"150px"},children:Object(i.jsx)(Z.a,{title:Object(i.jsx)("div",{children:b[n].description}),children:Object(i.jsx)(U.a,{variant:"contained",style:{height:"75%",width:"50%"},onClick:function(){e.reincarnate(n,s),t.push("/adventuring")},children:Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsx)("img",{src:M(n)})}),Object(i.jsx)(K.a,{item:!0,xs:12,children:b[n].name})]})})})})}):Object(i.jsx)(K.a,{container:!0,xs:3,justify:"space-around",style:{height:"150px"},children:Object(i.jsx)(K.a,{item:!0,xs:12,style:{textAlign:"center",height:"64%"},children:Object(i.jsx)(Z.a,{title:Object(i.jsx)("div",{children:"An unknown type of Demon. Selects a random Demon you have not already played as."}),children:Object(i.jsx)(U.a,{variant:"contained",style:{height:"100%",width:"50%"},onClick:function(){e.reincarnate("random",s),t.push("/adventuring")},children:Object(i.jsx)(K.a,{container:!0,children:Object(i.jsx)(K.a,{item:!0,xs:12,children:"???"})})})})})})}))]})]})}var ne=n(100),ie=n(737);function ae(e){return Object(i.jsxs)(c.a.Fragment,{children:[Object(i.jsxs)(K.a,{item:!0,container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:6,children:"Health"}),Object(i.jsxs)(K.a,{item:!0,xs:5,children:[e.character.currentHp.toFixed()," / ",e.character.maximumHp.toFixed()]})]}),Object(i.jsx)(K.a,{container:!0,direction:"row",children:Object.keys(Q).map((function(t){return Object(i.jsx)(K.a,{item:!0,xs:!0,children:Object(i.jsx)(Z.a,{title:Q[t].description({rank:Object(f.Decimal)(e.character.attributes[t]).toFixed()}),children:Object(i.jsxs)("div",{style:{textAlign:"center"},children:[Object(i.jsx)("img",{src:Q[t].icon}),Object(i.jsx)("div",{children:Object(i.jsx)("span",{style:{fontSize:"12"},children:Q[t].label})}),Object(i.jsx)("div",{children:Object(f.Decimal)(e.character.attributes[t]).toFixed()})]})})})}))})]})}function ce(e){return Object(i.jsx)(c.a.Fragment,{children:Object.keys(e.character.traits).map((function(t){return Object(i.jsx)(Z.a,{title:Object(i.jsxs)(c.a.Fragment,{children:[Object(i.jsxs)("span",{children:["Tier ",Object(f.Decimal)(e.character.traits[t]).toFixed(),": "]}),Object(i.jsx)("span",{dangerouslySetInnerHTML:{__html:v[t].description({rank:Object(f.Decimal)(e.character.traits[t])})}})]}),children:Object(i.jsx)("img",{src:v[t].icon})},t)}))})}function re(e){return Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsx)(Z.a,{title:"Your approach to combat",children:Object(i.jsxs)("span",{children:["Utilizing ",O[e.character.tactics].title," Tactics"]})})}),Object(i.jsx)(K.a,{container:!0,direction:"row",children:Object(i.jsx)(ee,{tactic:e.character.tactics})})]})}function se(e){return{against:function(t){var n=e.combat.precision,i=Object(f.Decimal)(u.get(t,["combat","evasion"],0));return{min:Object(f.Decimal)(j.mechanics.combat.baseMinimumDamageWeight).plus(i.times(3)),med:Object(f.Decimal)(j.mechanics.combat.baseMedianDamageWeight).plus(i).plus(n),max:Object(f.Decimal)(j.mechanics.combat.baseMaximumDamageWeight).plus(n.times(2))}}}}function oe(e){return{against:function(t){var n=Object(f.Decimal)(j.mechanics.combat.power.effectPerPoint).plus(1).pow(e.combat.power),i=Object(f.Decimal)(1).minus(j.mechanics.combat.power.effectPerPoint).pow(u.get(t,["combat","resilience"],0)),a=n.times(i);return{min:e.combat.minimumDamage.times(a).ceil(),med:e.combat.medianDamage.times(a).ceil(),max:e.combat.maximumDamage.times(a).ceil()}}}}var le=n(743);function ue(e){var t=Object(a.useMemo)((function(){return M(e.character.appearance)}),[e.character.appearance]),n=Object(a.useMemo)((function(){return se(e.character).against(e.enemy)}),[e.character,e.enemy]),c=Object(a.useMemo)((function(){return oe(e.character).against(e.enemy)}),[e.character,e.enemy]),r=Object.values(n).reduce((function(e,t){return e.plus(t)})),s=R(e.character.powerLevel),o=R(e.character.powerLevel.plus(1)),l=e.character.absorbedPower.minus(s);return Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsx)("img",{src:t,style:{height:"75px"}})}),Object(i.jsxs)(K.a,{item:!0,container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:!0,children:"Level"}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:e.character.powerLevel.toFixed()}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:"Latent Power Bonus"}),Object(i.jsxs)(K.a,{item:!0,xs:!0,children:[e.character.latentPower.times(j.mechanics.reincarnation.latentPowerEffectScale).times(100).toFixed(),"%"]})]}),void 0!==e.character.absorbedPower&&Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsx)("progress",{value:l.div(o).times(100).toNumber(),max:100,title:"".concat(l.toFixed(),"/").concat(o.toFixed())})}),Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,container:!0,children:Object(i.jsx)(K.a,{item:!0,xs:!0,children:Object(i.jsx)("strong",{children:"Attributes"})})}),Object(i.jsx)(ae,{character:e.character})]}),Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsx)("strong",{children:"Combat Statistics"})}),Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(Z.a,{title:"Your Power increases the damage your attacks deal by ".concat(Object(f.Decimal)(j.mechanics.combat.power.effectPerPoint).times(e.character.combat.power).times(100).toFixed(),"%."),children:Object(i.jsxs)(K.a,{item:!0,container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:!0,style:{textAlign:"center"},children:"Power"}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:e.character.combat.power.toFixed()})]})}),Object(i.jsx)(Z.a,{title:"Your Resilience reduces the damage your attacks deal by ".concat(Object(f.Decimal)(j.mechanics.combat.resilience.effectPerPoint).times(e.character.combat.resilience).times(100).toFixed(),"%."),children:Object(i.jsxs)(K.a,{item:!0,container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:!0,style:{textAlign:"center"},children:"Resilience"}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:e.character.combat.resilience.toFixed()})]})}),Object(i.jsx)(Z.a,{title:"Your Evasion reduces the severity of hits you take.",children:Object(i.jsxs)(K.a,{item:!0,container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:!0,style:{textAlign:"center"},children:"Evasion"}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:e.character.combat.evasion.toFixed()})]})}),Object(i.jsx)(Z.a,{title:"Your Precision increases the severity of hits you score.",children:Object(i.jsxs)(K.a,{item:!0,container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:!0,style:{textAlign:"center"},children:"Precision"}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:e.character.combat.precision.toFixed()})]})})]}),Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsx)("strong",{children:"Hit Chances"})}),Object(i.jsxs)(K.a,{item:!0,container:!0,xs:12,children:[Object(i.jsx)(K.a,{item:!0,xs:!0,children:Object(i.jsx)("em",{children:"Type"})}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:Object(i.jsx)("em",{children:"Chance"})}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:Object(i.jsx)("em",{children:"Damage"})}),Object(i.jsx)(K.a,{item:!0,xs:1})]}),Object(i.jsxs)(K.a,{item:!0,container:!0,xs:12,children:[Object(i.jsx)(K.a,{item:!0,xs:!0,children:"Glancing Hit"}),Object(i.jsxs)(K.a,{item:!0,xs:!0,children:[n.min.div(r).times(100).toFixed(2),"%"]}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:c.min.toFixed()}),Object(i.jsx)(K.a,{item:!0,xs:1,children:Object(i.jsx)(Z.a,{title:"Glancing hits deal 50% less  damage",children:Object(i.jsx)(le.a,{})})})]}),Object(i.jsxs)(K.a,{item:!0,container:!0,xs:12,children:[Object(i.jsx)(K.a,{item:!0,xs:!0,children:"Solid Hit"}),Object(i.jsxs)(K.a,{item:!0,xs:!0,children:[n.med.div(r).times(100).toFixed(2),"%"]}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:c.med.toFixed()}),Object(i.jsx)(K.a,{item:!0,xs:1,children:Object(i.jsx)(Z.a,{title:"Solid hits deal normal damage",children:Object(i.jsx)(le.a,{})})})]}),Object(i.jsxs)(K.a,{item:!0,container:!0,xs:12,children:[Object(i.jsx)(K.a,{item:!0,xs:!0,children:"Critical Hit"}),Object(i.jsxs)(K.a,{item:!0,xs:!0,children:[n.max.div(r).times(100).toFixed(2),"%"]}),Object(i.jsx)(K.a,{item:!0,xs:!0,children:c.max.toFixed()}),Object(i.jsx)(K.a,{item:!0,xs:1,children:Object(i.jsx)(Z.a,{title:"Critical hits deal 50% more damage.",children:Object(i.jsx)(le.a,{})})})]})]})]}),Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsx)("strong",{children:"Traits"})}),Object(i.jsx)(ce,{character:e.character})]}),j.mechanics.artifacts.enabled&&Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsx)("strong",{children:"Artifacts"})}),Object(i.jsx)(K.a,{children:JSON.stringify(e.character.items)})]}),Object(i.jsx)(re,{character:e.character})]})}var de={root:{width:"25%",backgroundColor:"#eeeeee"}};function me(e){return Object(i.jsx)(ie.a,{style:de.root,elevation:2,children:Object(i.jsx)(ue,{character:e.player,enemy:e.enemy})})}var he={root:{height:"100%",display:"flex",flex:"0"},buttons:{width:"100%"}};function be(e){var t=Object(Y.d)(),n=Object(a.useMemo)((function(){return C(0).powerLevel.gt(1)||!C(0).isAlive}),[C(0).powerLevel,C(0).isAlive]);return Object(i.jsx)("div",{style:he.root,children:Object(i.jsx)(U.a,{onClick:function(){return t.push("/reincarnating")},style:he.buttons,variant:"contained",color:"secondary",disabled:!n,children:"Reincarnate"})})}function ge(e){return Object(i.jsxs)(K.a,{item:!0,container:!0,xs:!0,children:[Object(i.jsxs)(K.a,{item:!0,xs:12,container:!0,direction:e.direction,children:[Object(i.jsx)(K.a,{item:!0,xs:6,children:e.name}),Object(i.jsx)(K.a,{item:!0,xs:6,children:Object(i.jsx)("meter",Object($.a)({style:{width:"80%"},low:33,high:66,optimum:100,min:0,max:100,value:e.currentHp.div(e.maximumHp).times(100).floor().toNumber()},"max",100))})]}),Object(i.jsx)(K.a,{container:!0,item:!0,xs:12,style:{height:"40px"},direction:e.direction,children:e.statuses&&Object.keys(e.statuses).map((function(e){return Object(i.jsx)(K.a,{item:!0,xs:1,children:Object(i.jsx)("img",{src:x[e].icon})})}))})]})}var je={root:{display:"flex",flex:"1 0 auto",justifyContent:"flex-end",flexDirection:"column"},actions:{container:{display:"flex",justifyContent:"space-between",flexDirection:"row"},buttons:{alignSelf:"flex-end",flex:"1"}},action:{maxHeight:"15%",width:"100%",display:"flex",flexDirection:"column"},actionProgress:{width:"100%"},history:{height:"15%",flexDirection:"column",overflowY:"scroll"},combat:{}};function pe(e){if(!e.currentAction)throw new Error("No current action");var t=e.enemy?F(j.encounters.chanceToEscapeGreater,{player:e.player,enemy:e.enemy}):Object(f.Decimal)(100),n=e.enemy?F(j.encounters.chanceToIntimidateLesser,{player:e.player,enemy:e.enemy}):Object(f.Decimal)(100);return Object(i.jsxs)("div",{style:je.root,onMouseEnter:e.startManualSpeedup,onMouseLeave:e.stopManualSpeedup,children:[Object(i.jsx)(ie.a,{style:je.actions.container,children:Object(i.jsx)(U.a,{style:je.actions.buttons,onClick:function(){E().paused=!E().paused,e.togglePause(E().paused)},children:e.paused?"Unpause":"Pause"})}),Object(i.jsxs)(ie.a,{style:je.actions.container,children:[fe("fighting","Fight","Combat the enemy. On victory, steal some of the power of the vanquished foe.",e),fe("fleeing","Flee","Attempt to escape. Your chance is  ".concat(t,"%."),e),fe("intimidating","Intimidate","Try to cow the enemy, compelling them to continuously provide you a portion of their life force. Your chance is ".concat(n,"%"),e),u.get(j,"features.negotiating.enabled")&&fe("negotiating","Negotiate","Combat the enemy. On victory, steal some of the power of the vanquished foe.",e)]}),Object(i.jsx)(ie.a,{style:je.combat.details,children:Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(ge,{name:"Player",currentHp:e.player.currentHp,maximumHp:e.player.maximumHp,statuses:u.get(e.player,"statuses"),direction:"row"}),Object(i.jsx)(ge,{name:u.get(e.enemy,"name"),currentHp:u.get(e.enemy,"currentHp",Object(f.Decimal)(0)),maximumHp:u.get(e.enemy,"maximumHp",Object(f.Decimal)(100)),statuses:u.get(e.enemy,"statuses"),direction:"row-reverse"})]})}),Object(i.jsxs)(ie.a,{style:je.action,children:[Object(i.jsx)("strong",{children:e.currentAction.description}),Object(i.jsx)("progress",{style:je.actionProgress,value:e.actionTime,max:u.get(e.state,e.currentAction.duration)})]}),Object(i.jsx)(ie.a,{style:je.history,children:e.actionLog.map((function(e){return function(e){return Object(i.jsxs)(K.a,{container:!0,direction:"row-reverse",style:{textAlign:"center"},children:[Object(i.jsx)(K.a,{item:!0,xs:11,children:Object(i.jsx)("span",{dangerouslySetInnerHTML:{__html:e.message}})}),e.tick&&Object(i.jsxs)(K.a,{item:1,children:[e.tick,": "]})]},e.uuid)}(e)}))})]})}function fe(e,t,n,a){return Object(i.jsx)(Z.a,{title:n,children:Object(i.jsx)(U.a,{onClick:function(){return a.setNextAction(e)},style:je.actions.buttons,disabled:"approaching"!==a.currentAction.id,variant:a.nextActionName===e?"contained":"outlined",color:a.nextActionName===e?"primary":"default",children:t})})}var Oe={root:{width:"25%",backgroundColor:"#eeeeee"}};function xe(e){return Object(i.jsx)(ie.a,{style:Oe.root,children:e.enemy&&Object(i.jsx)(ue,{enemy:e.player,character:e.enemy})})}var ve=function(){function e(t,n){Object(m.a)(this,e),this.id=t.id,this.attributes=new k(t.attributes,t),this.party=n,this.hp=t.currentHp,this._speed=t.speed,this.maximumHp=t.maximumHp,this.fatigue=0,this.lastActed=0,this.modifiers=[],this.tactics=t.tactics,this.traits=Object(d.a)({},t.traits),this.damage={min:t.combat.minimumDamage,med:t.combat.medianDamage,max:t.combat.maximumDamage},this.statuses=Object(d.a)({},t.statuses)}return Object(h.a)(e,[{key:"combat",get:function(){return{precision:Object(f.Decimal)(this.precision),evasion:Object(f.Decimal)(this.evasion),power:Object(f.Decimal)(this.power),resilience:Object(f.Decimal)(this.resilience),minimumDamage:Object(f.Decimal)(this.damage.min),medianDamage:Object(f.Decimal)(this.damage.med),maximumDamage:Object(f.Decimal)(this.damage.max)}}},{key:"speed",set:function(e){this._speed=e},get:function(){var e=this._speed,t=this.modifiers.reduce((function(e,t){if(t.effects.speed){var n=t.effects.speed.percent.plus(100)/100;return e.plus(n)}return e}),u.get(j.tactics,this.tactics,1));return e.times(t)}},{key:"isAlive",get:function(){return this.hp.gt(0)}},{key:"accuracy",get:function(){var e=Object(f.Decimal)(j.mechanics.combat.baseHitChance),t=Object(f.Decimal)(1).minus(Object(f.Decimal)(x.restrained.effects.accuracy_modifier).times(this.statuses.restrained||0));return e.times(t)}},{key:"canAct",get:function(){return Object.keys(this.statuses).reduce((function(e,t){return e&&!x[t].effects.skip_turn}),!0)}},{key:"power",get:function(){var e=this.attributes[j.mechanics.combat.power.baseAttribute],t=Object(f.Decimal)(1).plus(O[this.tactics].power_modifier||0),n=Object.keys(this.statuses).reduce((function(e,t){var n=x[t];return e.plus(n.effects.power_multiplier||0).minus(1)}),Object(f.Decimal)(1));return e.times(t.plus(n))}},{key:"resilience",get:function(){var e=this.attributes[j.mechanics.combat.resilience.baseAttribute],t=Object(f.Decimal)(1).plus(O[this.tactics].resilience_modifier||0),n=Object.keys(this.statuses).reduce((function(e,t){var n=x[t];return e.plus(n.effects.resilience_multiplier||0).minus(1)}),Object(f.Decimal)(1));return e.times(t.plus(n))}},{key:"precision",get:function(){var e=this.attributes[j.mechanics.combat.precision.baseAttribute],t=Object(f.Decimal)(1).plus(O[this.tactics].precison_modifier||0),n=Object.keys(this.statuses).reduce((function(e,t){var n=x[t];return e.plus(n.effects.precision_multiplier||0).minus(1)}),Object(f.Decimal)(1));return e.times(t.plus(n))}},{key:"evasion",get:function(){var e=this.attributes[j.mechanics.combat.evasion.baseAttribute],t=Object(f.Decimal)(1).plus(O[this.tactics].evasion_modifier||0),n=Object.keys(this.statuses).reduce((function(e,t){var n=x[t];return e.plus(n.effects.evasion_multiplier||0).minus(1)}),Object(f.Decimal)(1));return e.times(t.plus(n))}}]),e}();n(408);function ye(e,t){var n={rounds:[],winner:null,combatantCombatStats:{}};u.flatMap(t.parties.map((function(e,t){return e.map((function(e){n.combatantCombatStats[e.id]=new ve(e,t)}))}))),p("Beginning combat"),Object.values(n.combatantCombatStats).forEach((function(t){var i=[];we(t,null,Object.values(n.combatantCombatStats),{type:"on_combat_start"},0,{combat:n,round:{effects:i}},e),i.forEach((function(e){n.rounds.push(e)}))}));for(var i=0,a=function(){var a,c=(a=n,Object.values(a.combatantCombatStats).reduce((function(e,t){return e[t.speed.toNumber()]?e[t.speed.toNumber()].push(t):e[t.speed.toNumber()]=[t],e}),{}));Object.keys(c).forEach((function(a){c[a].forEach((function(a){var c=[];if(we(a,null,Object.values(n.combatantCombatStats),{type:"on_round_start"},i,{combat:n,round:{effects:c}},e),c.forEach((function(e){n.rounds.push(e)})),i=a.lastActed+a.speed.toNumber(),a.lastActed=i,p("Tick ".concat(i,": Resolving action by character '").concat(a.id,"'.")),a.hp.lte(0))p("Tick ".concat(i,": Character ").concat(a.id," was dead when their turn to act came up, skipping their action."));else{var r=(a.party+1)%2,s=t.parties[r].filter((function(e){return n.combatantCombatStats[e.id].hp.gt(0)})),o=n.combatantCombatStats[u.get(s[Math.floor(e.double()*s.length)],"id")];if(void 0!==o){if(a.canAct){p("Tick ".concat(i,": Attacking ").concat(o));var d=function(e,t,n,i){var a=e.accuracy.plus(Math.floor(100*i.double()));return{rawRoll:a,total:a}}(a,0,0,e);switch(F(j.mechanics.combat.determineHit,{roll:d.total,target:100})){case"hit":p("Tick ".concat(i,": ").concat(a.id," rolled ").concat(d.total,", a hit.")),function(e,t,n,i,a){if("object"!==typeof n)throw new Error("Acting character was not an object!");if("object"!==typeof i)throw new Error("Target character was not an object!");var c,r=se(n).against(i),s=oe(n).against(i),o=Math.floor(100*a.double());o<=r.min?(c="min",p("Tick ".concat(e,": Damage roll ").concat(o,", a glancing hit."))):o<=r.med.plus(r.min)?(c="med",p("Tick ".concat(e,": Damage roll ").concat(o,", a solid hit."))):(c="max",p("Tick ".concat(e,": Damage roll ").concat(o,", a critical hit.")));var u={baseDamage:s[c],hitType:c,attackMultiplier:n.power.times(j.mechanics.combat.power.effectPerPoint),defenseDivisor:i.resilience.times(j.mechanics.combat.resilience.effectPerPoint),effects:[]};we(n,i,Object.values(t.combatantCombatStats),{type:"on_hitting"},e,{combat:t,attack:u},a);var d=f.Decimal.max(.01,u.attackMultiplier.minus(u.defenseDivisor).plus(1)),m=u.baseDamage.times(d).ceil();p("Damage started off as ".concat(u.baseDamage.toFixed(),", with an attack factor of ").concat(u.attackMultiplier," and a target defense factor of ").concat(u.defenseDivisor,", for a total factor of ").concat(d," and a final damage of ").concat(m.toFixed())),i.hp=i.hp.minus(m),u.finalDamage=m,p("Tick ".concat(e,": Hit did ").concat(m.toFixed(),". Additional effects: ").concat(u.effects.map((function(e){switch(e.event){case"apply_effect":return"Applying effect ".concat(e.effect," with from ").concat(e.source," to ").concat(e.target.id,".");case"add_statuses":return"Adding status ".concat(e.status," with rank ").concat(e.rank," to ").concat(e.target)}})).join(", "),". Character ").concat(i.id," has ").concat(i.hp," remaining.")),we(n,i,Object.values(t.combatantCombatStats),{type:"on_taking_damage",attacker:n,target:i},e,{combat:t,attack:u},a),u.effects.forEach((function(e){switch(e.event){case"damage":t.combatantCombatStats[e.target].hp=t.combatantCombatStats[e.target].hp.minus(e.value)}})),t.rounds.push(function(e,t,n,i,a){return{uuid:Object(l.v4)(),tick:e,result:"hit",target:n,actor:t,effects:[{event:"damage",value:i,target:n}].concat(Object(ne.a)(a))}}(e,n.id,i.id,m,u.effects))}(i,n,a,o,e);break;default:p("Tick ".concat(i,": ").concat(a.id," rolled ").concat(d.total,", a miss.")),function(e,t,n,i,a){t.rounds.push(function(e,t,n){return{uuid:Object(l.v4)(),tick:e,result:"miss",target:n,actor:t,effects:[]}}(e,n.id,i.id))}(i,n,a,o)}}else p("".concat(i,": Character skips their action.")),function(e,t,n){t.rounds.push(function(e,t){return{uuid:Object(l.v4)(),tick:e,result:"action_skipped",actor:t,effects:[]}}(e,n.id))}(i,n,a);Object.keys(n.combatantCombatStats).forEach((function(e){n.combatantCombatStats[e].hp.lte(0)&&(p("Tick ".concat(i,": Combatant ").concat(e," died")),n.rounds.push({uuid:Object(l.v4)(),tick:i,actor:a.id,target:Number.parseInt(e),result:"kill"}))})),a.modifiers=a.modifiers.map((function(e){return e.roundDuration=Object(f.Decimal)(e.roundDuration).minus(1),e})).filter((function(e){return Object(f.Decimal)(e.roundDuration).gt(0)}));var m=[];we(a,null,Object.values(n.combatantCombatStats),{type:"on_round_end"},i,{combat:n,round:{effects:m}},e),Object.keys(a.statuses).filter((function(e){return x[e].decays})).forEach((function(e){Object(f.Decimal)(0).lt(a.statuses[e]||0)?a.statuses[e]=a.statuses[e].minus(1):(delete a.statuses[e],n.rounds.push({uuid:Object(l.v4)(),tick:i,actor:a.id,result:"status-removed",status:e}))})),m.forEach((function(e){n.rounds.push(e)}))}else p("Tick ".concat(i,": No valid target, skipping action by ").concat(a.id,"."))}}))}));var r=t.parties[0].every((function(e){return n.combatantCombatStats[e.id].hp.lte(0)})),s=t.parties[1].every((function(e){return n.combatantCombatStats[e.id].hp.lte(0)}));r||s?r?(p("Every member of party 0 is dead"),n.rounds.push({uuid:Object(l.v4)(),tick:i,winner:1,result:"combat-end"}),n.winner=1):s&&(p("Every member of party 1 is dead"),n.rounds.push({uuid:Object(l.v4)(),tick:i,winner:0,result:"combat-end"}),n.winner=0):p("No winner, combat continues")};null===n.winner;)a();return n}function ke(e,t,n,i,a){return n.filter((function(n){switch(i){case"attacker":return e.id==n.id;case"attacked":return t.id==n.id;case"all_enemies":return(0===e.id?0:1)!==n.party;default:throw new Error}}))}function we(e,t,n,i,a,c,r){p("Triggering event ".concat(i.type)),Object.keys(e.traits).forEach((function(n){var s;!function(e,t,n,i,a,c,r,s){var o=a.type,l=De.includes(o)?c.round.effects:c.attack.effects,u=Object(f.Decimal)(e.attributes[j.mechanics.combat.traitRank.baseAttribute]).times(j.mechanics.combat.traitRank.effectPerPoint).div(100);if(i=f.Decimal.min(Object(f.Decimal)(i).plus(Object(f.Decimal)(i).times(u)).floor(),100),p("Character has a bonus to rank of ".concat(e.attributes.madness.toFixed(),"% from madness, for an effective rank of ").concat(i)),p("Tick ".concat(r,": Determining if trait ").concat(n.name," applies")),n[o]){var d=n[o];void 0!==d.conditions&&p("Trait has conditions"),(void 0===d.conditions||Object.keys(d.conditions).every((function(a){switch(a){case"critical_hit":return"max"===c.attack.hitType;case"health_percentage":return ke(e,t,Object.values(c.combat.combatantCombatStats),"all_enemies").reduce((function(e,t){var n=Object(f.Decimal)(d.conditions[a].below),i=t.hp,c=t.maximumHp,s=i.mul(100).div(c),o=n.gte(s);return p("Tick ".concat(r,": Target health percentage is ").concat(s,", which is ").concat(o?"":"not"," enough to trigger.")),e&&o}),!0);case"chance":var l=F(n[o].conditions[a],{$rank:i}),u=Math.floor(100*s.double())+1;return l>=u?(p("Chance to trigger ".concat(l," with roll ").concat(u,": success")),!0):(p("Chance to trigger ".concat(l," with roll ").concat(u,": failure.")),!1);default:return!1}})))&&(p("Tick ".concat(r,": Effect triggered, applying effects")),Object.keys(n[o].effects).forEach((function(a){switch(a){case"damage_modifier":var s=F(n[o].effects[a].percent,{$rank:i});if(s){var u=c.attack.attackMultiplier.plus(s);p("Tick ".concat(r,": Applying ").concat(s.toFixed()," modifier to damage, changing damage multiplier from ").concat(c.attack.attackMultiplier.div(100).toFixed()," to ").concat(u.div(100).toFixed())),c.attack.attackMultiplier=u}break;case"damage":var d=n[o].effects.target,m=F(n[o].effects.damage,{$rank:Object(f.Decimal)(i),attackDamage:c.attack.finalDamage}).floor();p("Inflicting ".concat(m," damage to ").concat(d)),m.gt(0)&&ke(e,t,Object.values(c.combat.combatantCombatStats),d).forEach((function(e){l.push({event:"damage",value:m,target:e.id})}));break;case"defense_modifier":var h=F(n[o].effects[a].percent,{$rank:i}).div(100).plus(1),b=c.attack.defenseDivisor.times(h);p("Tick ".concat(r,": Applying ").concat(h," modifier to defense, changing defense multiplier from ").concat(c.attack.defenseDivisor.toFixed()," to ").concat(b.toFixed())),c.attack.defenseDivisor=b;break;case"add_statuses":var g=n[o].effects.add_statuses;Object.keys(g).forEach((function(n){var a=g[n].target,s=ke(e,t,Object.values(c.combat.combatantCombatStats),a),o=F(g[n].rank,{rank:i});s.forEach((function(t){Object(f.Decimal)(t.statuses[n]||0).lt(o)&&(t.statuses[n]=o,l.push({event:"add_statuses",result:"add_statuses",source:e.id,target:t.id,status:n,level:o,tick:r}))}))}))}})))}}(e,t,(s=n,v[s]),e.traits[n],i,c,a,r)}))}var De=["on_round_start","on_combat_start","on_round_end"],_e=n(126);function Se(e){var t={original:e,tick:e.tick};if(e.message)return e;switch(e.result){case"hit":t.message="".concat(C(e.actor).name," hit! ").concat(e.effects.map((function(t){return Pe(e.target,t)})).join(" "));break;case"miss":t.message="".concat(C(e.actor).name," ").concat(0===e.actor?"miss":"missed","! ").concat(e.effects.map((function(t){return Pe(e.target,t)})).join(" "));break;case"kill":t.message="<strong>".concat(C(e.target).name," ").concat(0===e.target?"Were":"Was"," Killed!</strong>");break;case"gainedPower":t.message="You absorbed ".concat(e.value.toFixed()," power.");break;case"healed":t.message="".concat(C(e.target).name," gained ").concat(e.value," health.");break;case"escaped":t.message="You escaped";break;case"action_skipped":t.message="".concat(C(e.actor).name," lost ").concat(0===e.actor?"your":"their"," action.");break;case"intimidated":t.message="".concat(C(e.target).name," was Bound to you, granting you {item.value.toFixed()} power while you explore.");break;case"enemy-fled":t.message="".concat(C(e.target).name," Fled!");break;case"combat-end":t.message="Battle ended";break;case"add_statuses":t.message="".concat(C(e.target).name," ").concat(0===e.target?"gain":"gained"," ").concat(Object(f.Decimal)(e.level).toFixed()," ").concat(Object(f.Decimal)(e.level).eq(1)?"level":"levels"," of ").concat(x[e.status].name);break;case"status-removed":t.message="".concat(x[e.status].name," was removed from ").concat(C(e.actor).name,".");break;default:p("".concat(JSON.stringify(e)))}return t}function Pe(e,t){switch(t.event){case"damage":return"".concat(C(t.target).name," ").concat(0==t.target?"take":"takes"," ").concat(t.value," Damage.");case"add_statuses":return"".concat(C(t.target).name," gained ").concat(Object(f.Decimal)(t.level).toFixed()," of ").concat(x[t.status].name,".")}}var Ae,Ee={root:{display:"flex",flex:"1",flexDirection:"row",justifyContent:"space-between",overflow:"hidden"},image:{position:"absolute",height:"100%",left:0},background:{position:"absolute",height:"100%",width:"100%",left:0}};function Te(e){return E().currentAction=e,E().currentAction}function Le(e){E().actionLog.length>(j.actionLog.maxSize||10)&&E().actionLog.pop(),E().actionLog.unshift(Se(e))}function Ce(e){var t=Object(a.useRef)(0),n=Object(a.useState)(u.get(E(),["currentEncounter","enemies",0])),c=Object(o.a)(n,2),r=c[0],s=c[1],d=Object(a.useState)(E().actionLog),m=Object(o.a)(d,2),h=m[0],b=m[1],g=Object(a.useState)(E().currentEncounter),O=Object(o.a)(g,2),x=(O[0],O[1]),y=Object(a.useState)(B[E().currentAction]),k=Object(o.a)(y,2),w=k[0],D=k[1],_=Object(a.useState)(E().nextAction),S=Object(o.a)(_,2),P=S[0],L=S[1],H=Object(a.useState)(E().paused),M=Object(o.a)(H,2),R=M[0],N=M[1],I=Object(a.useState)(0),W=Object(o.a)(I,2),G=W[0],Y=W[1],K=Object(a.useState)(C(0)),U=Object(o.a)(K,2),z=U[0],J=(U[1],Object(a.useRef)(!1));return Object(_e.a)("p",(function(){return E().paused=!E().paused})),Object(a.useEffect)((function(){var n;function i(e,t){if(t&&e.tick&&e.tick!==t)p("Not consuming an action for tick ".concat(e.tick," on tick ").concat(t));else{switch(Le(e),e.result){case"combat-end":return j.mechanics.artifacts.enabled?D(B[Te("looting")]):D(B[Te("exploring")]),void(C(0).isAlive&&(x(E().currentEncounter=null),s(null)));case"kill":var n=C(e.target);if(0===e.actor&&0!==e.target){p("Player killed a non-lesser enemy and gained power.");var a=C(0),c=F(j.mechanics.xp.gainedFromOtherDemon,{enemy:n}),r=Object.keys(a.traits).reduce((function(e,t){var n=F(u.get(v[t].on_kill,["effects","power_gain_modifier"],0),{rank:Object(f.Decimal)(a.traits[t])});return e.plus(n)}),Object(f.Decimal)(1));Le(Se({result:"gainedPower",value:a.gainPower(c.times(r).floor())})),E().highestLevelReached=f.Decimal.max(E().highestLevelReached,C(0).powerLevel)}else 0===e.target&&(C(0).currentHp=Object(f.Decimal)(0),D(E().currentAction="dead"),N(E().paused=!0));break;case"hit":case"miss":(e.effects||[]).forEach((function(e){var t=C(e.target);switch(e.event){case"damage":t.currentHp=t.currentHp.minus(e.value),t.currentHp.lt(Object(f.Decimal)(0))&&(t.currentHp=Object(f.Decimal)(0));break;case"add_statuses":C(e.target).statuses[e.status]=e.level}}));break;case"add_statuses":C(e.target).statuses[e.status]=e.level;break;case"status-removed":delete C(e.actor).statuses[e.status];case"action_skipped":break;default:throw new Error}E().currentEncounter.pendingActions.shift(),T();var o=E().currentEncounter.pendingActions[0];o&&i(o,e.tick)}}return console.log("Adventuring Page"),n=requestAnimationFrame((function a(c){if(Ae){if(!E().paused&&C(0).isAlive){if(t.current>=u.get(E(),B[E().currentAction].duration)){var r=C(0);switch(T(),t.current=0,E().currentAction){case"exploring":C(0).clearStatuses();var o=!1;if(C(0).currentHp.lt(C(0).maximumHp)){var d=F(j.mechanics.combat.randomEncounterChance,{player:r}),m=d.lte(0)||C(0).currentHp.plus(C(0).healing).gt(C(0).maximumHp)?C(0).maximumHp.minus(C(0).currentHp):C(0).healing;C(0).currentHp=C(0).currentHp.plus(m),Le({message:"You naturally healed ".concat(m," health"),uuid:Object(l.v4)()});var h=Math.floor(100*e.rng.double())+1;p("Determining if encounter occurs. Chance ".concat(d," vs roll ").concat(h,".")),d.gte(h)?o=!0:d.eq(0)?Le({message:"You weak spiritual energy keeps you hidden while you heal.",uuid:Object(l.v4)()}):Le({message:"You don't find any trouble while you recover.",uuid:Object(l.v4)()})}else o=!0;if(o){if(E().currentEncounter=q[E().currentRegion].startEncounter(C(0),e.rng),x(E().currentEncounter),s(E().currentEncounter.enemies[0]),D(B[Te("approaching")]),E().nextAction=E().currentEncounter.enemies.reduce((function(e,t){return"fighting"!==e?e:r.otherDemonIsLesserDemon(t)?"intimidating":r.otherDemonIsGreaterDemon(t)?"fleeing":"fighting"}),"fighting"),L(E().nextAction),E().passivePowerIncome.gt(0)){var g=C(0).gainPower(E().passivePowerIncome);Le({message:"Your Bound lesser demons grant you ".concat(g.toFixed()," power."),uuid:Object(l.v4)()}),E().highestLevelReached=f.Decimal.max(E().highestLevelReached,C(0).powerLevel)}var O=E().currentEncounter.enemies;r.otherDemonIsGreaterDemon(O[0])?Le({message:"<strong>\ud83d\udc80Approaching Greater ".concat(O[0].name,".\ud83d\udc80</strong>"),uuid:Object(l.v4)()}):r.otherDemonIsLesserDemon(O[0])?Le({message:"<strong>Approaching Lesser ".concat(O[0].name,".</strong>"),uuid:Object(l.v4)()}):Le({message:"<strong>Approaching ".concat(O[0].name,".</strong>"),uuid:Object(l.v4)()}),T()}break;case"approaching":switch(E().nextAction){case"fighting":var v=E().currentEncounter.enemies,y=ye(e.rng,{parties:[[r],v]});E().currentEncounter.pendingActions=y.rounds,s(v[0])}D(B[Te(E().nextAction)]),L(),Object.keys(E().characters).filter((function(e){return"0"!==e&&!E().currentEncounter.enemies.find((function(t){return t.id==e}))})).forEach((function(e){delete E().characters[e]}));break;case"intimidating":var k=E().currentEncounter.enemies[0],w=F(j.encounters.chanceToIntimidateLesser,{enemy:k,player:C(0)}),_=Math.floor(100*e.rng.double())+1;if(w.gte(_)){var S=F(j.mechanics.xp.gainedFromLesserDemon,{enemy:k});Le(Se({result:"intimidated",target:k.id,value:S})),E().passivePowerIncome=E().passivePowerIncome.plus(S)}else Le(Se({message:"".concat(C(k.id).name," escaped! (You rolled ").concat(_," vs ").concat(w," chance to Bind).")})),x(E().currentEncounter=null);D(B[Te("exploring")]);break;case"fleeing":var P=E().currentEncounter.enemies[0],H=F(j.encounters.chanceToEscapeGreater,{enemy:P,player:C(0)}),M=Math.floor(100*e.rng.double())+1;if(H.gte(M)){Le({result:"escaped",uuid:Object(l.v4)()});var R=F(j.mechanics.xp.gainedFromGreaterDemon,{$enemy:P}),I=r.gainPower(R);E().highestLevelReached=f.Decimal.max(E().highestLevelReached,C(0).powerLevel),Le(Se({result:"gainedPower",value:I})),E().currentEncounter=null,x(null),D(B[Te("exploring")])}else{Le({message:"The ".concat(P.name," caught you! (Roll ").concat(M," vs ").concat(H,")"),uuid:Object(l.v4)()});var W=E().currentEncounter.enemies,G=ye(e.rng,{parties:[[r],W]});E().currentEncounter.pendingActions=G.rounds,s(W[0]),L(B[Te("fighting")]),D(B[Te("fighting")])}break;case"fighting":if(E().currentEncounter.pendingActions.length)i(E().currentEncounter.pendingActions[0]),b(Object(ne.a)(E().actionLog));else D(B[Te("fleeing")]);break;case"looting":Math.floor(666*e.rng.double());E().currentEncounter.encounterLevel,D(B[Te("exploring")]);break;case"reincarnating":x(),D(B[Te("exploring")]),b([]),E().actionLog=[];break;case"dead":N(E().paused=!0);break;default:if(j.debug)throw new Error("Action ".concat(E().currentAction," not supported."));x(),D(B[Te("exploring")]),b([])}}Y(t.current);var $=(c-Ae)*(J.current?function(){var e=u.get(A,["debug","manualSpeedMultiplier"]),t=A.manualSpeedMultiplier;return e||t}():1);0===Math.min(t.current+$,u.get(E(),B[E().currentAction].duration))&&(t.current+$===0?p("Timestamp ".concat(c,", last time ").concat(Ae)):p("Action duration was 0")),t.current=Math.min(t.current+$,u.get(E(),B[E().currentAction].duration))}}else Ae=c;Ae===c&&p("New and previous timestamp were identical"),Ae=c,n=requestAnimationFrame(a),b(Object(ne.a)(E().actionLog))})),function(){console.log("Cancel frame"),cancelAnimationFrame(n)}}),[]),Object(i.jsxs)("div",{className:"App",style:Ee.root,onMouseOver:function(){return J.current=!0},onMouseLeave:function(){return J.current=!1},children:[Object(i.jsxs)("div",{id:"background",style:{position:"absolute",zIndex:"-10",overflow:"hidden",height:"100vh",width:"100vw"},children:[Object(i.jsx)("img",{style:Ee.background,src:"./backgrounds/parallax-demon-woods-bg.png"}),Object(i.jsx)("img",{style:Ee.image,src:"./backgrounds/parallax-demon-woods-far-trees.png"}),Object(i.jsx)("img",{style:Ee.image,src:"./backgrounds/parallax-demon-woods-mid-trees.png"}),Object(i.jsx)("img",{style:Ee.image,src:"./backgrounds/parallax-demon-woods-close-trees.png"})]}),Object(i.jsx)(me,{player:z,enemy:r}),Object(i.jsxs)("div",{style:{display:"flex",flex:"1 0 auto",flexDirection:"column"},children:[Object(i.jsx)(be,{character:z}),Object(i.jsx)(pe,Object($.a)({state:E(),actionLog:h,player:z,enemy:r,togglePause:function(){E().paused=!E().paused,N(E().paused)},paused:R,nextActionName:P,currentAction:w,setNextAction:function(e){L(E().nextAction=e)},actionTime:G,startManualSpeedup:e.startManualSpeedup,stopManualSpeedup:e.stopManualSpeedup},"togglePause",(function(e){return N(e)})))]}),Object(i.jsx)(xe,{player:z,enemy:r})]})}var He=n(738),Me=n(175),Fe=n.n(Me),Re=n(176),Ne=n.n(Re),Ie={root:{position:"absolute",minHeight:"100vh",bottom:0,left:0,padding:"20px"}};function We(e){var t=Object(a.useState)(u.get(E(),["debug","creatures"])),n=Object(o.a)(t,2),c=n[0],r=n[1],s=Object(a.useState)(u.get(E(),["debug","regions"])),l=Object(o.a)(s,2),m=l[0],h=l[1],g=Object(a.useState)(u.get(E(),["debug","encounters","minLevel"],C(0).powerLevel.minus(j.encounters.lesserLevelScale).lt(Object(f.Decimal)(1))?Object(f.Decimal)(1):C(0).powerLevel.minus(j.encounters.lesserLevelScale))),p=Object(o.a)(g,2),O=p[0],x=p[1],v=Object(a.useState)(u.get(E(),["debug","encounters","maxLevel"],C(0).powerLevel.plus(j.encounters.greaterLevelScale).gt(100)?Object(f.Decimal)(100):C(0).powerLevel.plus(2*j.encounters.greaterLevelScale))),y=Object(o.a)(v,2),k=y[0],w=y[1],D=Object(a.useState)(u.get(E(),["debug","manualSpeedMultiplier"],E().manualSpeedMultiplier)),_=Object(o.a)(D,2),P=_[0],T=_[1],L=Object(a.useState)(C(0).absorbedPower),H=Object(o.a)(L,2),M=H[0],F=H[1];return Object(i.jsx)(ie.a,{style:Ie.root,disabled:!0,children:Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(i.jsx)("h3",{children:"Debug Menu"})}),Object(i.jsxs)(K.a,{item:!0,container:!0,xs:12,children:[Object(i.jsx)(K.a,{item:!0,xs:6,style:{textAlign:"center"},children:Object(i.jsx)(U.a,{variant:"contained",color:"secondary",onClick:function(){A.debug.creatures={},A.debug.regions={},r(u.get(E(),["debug","creatures"])),h(u.get(E(),["debug","regions"])),x(C(0).powerLevel.minus(j.encounters.lesserLevelScale).lt(Object(f.Decimal)(1))?Object(f.Decimal)(1):C(0).powerLevel.minus(j.encounters.lesserLevelScale)),w(C(0).powerLevel.plus(j.encounters.greaterLevelScale).gt(100)?Object(f.Decimal)(100):C(0).powerLevel.plus(2*j.encounters.greaterLevelScale))},children:"Reset Debug Settings"})}),Object(i.jsx)(K.a,{item:!0,xs:6,style:{textAlign:"center"},children:Object(i.jsx)(U.a,{variant:"contained",color:"secondary",onClick:function(){window.localStorage.removeItem(S),alert("local storage cleared")},children:"Clear Save"})})]}),Object(i.jsxs)(K.a,{item:!0,xs:12,children:[Object(i.jsx)(K.a,{item:!0,xs:3,children:Object(i.jsx)(He.a,{type:"number",value:P,onChange:function(e){var t=Number.parseInt(e.target.value);u.set(E(),["debug","manualSpeedMultiplier"],t),T(t)},label:"Manual speed multiplier"})}),Object(i.jsx)(K.a,{item:!0,xs:3,children:Object(i.jsx)(He.a,{type:"number",min:"0",value:M,onChange:function(e){e.target.value=""===e.target.value?0:e.target.value;var t=Object(f.Decimal)(Number.parseInt(e.target.value));t.lt(0)?(C(0).absorbedPower=Object(f.Decimal)(0),F(Object(f.Decimal)(0))):(C(0).absorbedPower=t,F(t))},label:"Current player absorbed power"})})]}),Object(i.jsx)(K.a,{item:!0,xs:12,children:Object(i.jsx)("h3",{children:"Creatures"})}),Object(i.jsx)(K.a,{container:!0,item:!0,xs:12,children:Object.keys(b).map((function(e){var t=!1!==c[e]&&!1!==u.get(c,[e,"enabled"]);return Object(i.jsx)(K.a,{item:!0,xs:3,style:{height:"100%"},children:Object(i.jsxs)(U.a,{variant:"contained",color:t?"default":"secondary",style:{width:"100%",height:"100%"},onClick:function(){u.set(E(),["debug","creatures",e,"enabled"],!t),r(Object(d.a)(Object(d.a)({},c),{},Object($.a)({},e,{enabled:!t})))},children:[Object(i.jsx)("img",{src:"./monsters/".concat(b[e].texture)}),b[e].name]})})}))}),Object(i.jsx)(K.a,{item:!0,style:{textAlign:"center"},children:Object(i.jsx)("h4",{children:"Regions"})}),Object(i.jsx)(K.a,{container:!0,item:!0,xs:12,children:Object.keys(q).map((function(e){return Object(i.jsxs)(K.a,{item:!0,xs:6,style:{textAlign:"center"},children:[Object(i.jsx)("h4",{children:q[e].name}),Object(i.jsx)(K.a,{item:!0,container:!0,xs:12,children:Object.keys(q[e].encounters).map((function(t){var n=!1!==u.get(m,[e,"encounters",t,"enabled"]);return Object(i.jsx)(K.a,{item:!0,xs:3,children:Object(i.jsx)(U.a,{variant:"contained",color:n?"default":"secondary",style:{width:"100%",height:"100%"},onClick:function(){u.set(E(),["debug","regions",e,"encounters",t,"enabled"],!n),h(Object(d.a)(Object(d.a)({},m),{},Object($.a)({},e,u.set(m[e],["encounters",t,"enabled"],!n))))},children:q[e].encounters[t].description})})}))})]})}))}),Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsx)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(i.jsx)("h4",{children:"Encounter rules"})}),Object(i.jsxs)(K.a,{container:!0,item:!0,xs:3,children:[Object(i.jsx)(K.a,{item:!0,children:Object(i.jsx)(U.a,{onClick:function(){x(O.plus(1)),u.set(E(),["debug","encounters","minLevel"],O.plus(1)),O.plus(1).gt(k)&&(w(O.plus(1)),u.set(E(),["debug","encounters","maxLevel"],O.plus(1)))},children:Object(i.jsx)(Fe.a,{})})}),Object(i.jsxs)(K.a,{item:!0,children:["Minimum level ",O.toFixed()]}),Object(i.jsx)(K.a,{item:!0,children:Object(i.jsx)(U.a,{onClick:function(){u.set(E(),["debug","encounters","minLevel"],O.minus(1)),x(O.minus(1))},children:Object(i.jsx)(Ne.a,{})})})]}),Object(i.jsxs)(K.a,{container:!0,item:!0,xs:3,children:[Object(i.jsx)(K.a,{item:!0,children:Object(i.jsx)(U.a,{onClick:function(){w(k.plus(1)),u.set(E(),["debug","encounters","maxLevel"],k.plus(1))},children:Object(i.jsx)(Fe.a,{})})}),Object(i.jsxs)(K.a,{item:!0,children:["Maximum level ",k.toFixed()]}),Object(i.jsx)(K.a,{item:!0,children:Object(i.jsx)(U.a,{onClick:function(){u.set(E(),["debug","encounters","maxLevel"],k.minus(1)),w(k.minus(1)),k.minus(1).lt(O)&&(x(k.minus(1)),u.set(E(),["debug","encounters","minLevel"],k.minus(1)))},children:Object(i.jsx)(Ne.a,{})})})]})]})]})})}var qe=n(172),Be=n(703);function Ge(e){Object(a.useEffect)((function(){E().paused=!0}));var t=Object(Y.d)();return Object(i.jsx)(ie.a,{children:Object(i.jsxs)(K.a,{container:!0,children:[Object(i.jsxs)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:["Conquest of Hell Ver. ",qe.version," Save Compatibility NOT Guaranteed"]}),Object(i.jsx)(K.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(i.jsx)(U.a,{onClick:function(){null===E().currentAction?t.push("/reincarnating"):(E().paused=!1,t.push("/adventuring"))},variant:"contained",color:"primary",children:"Start"})}),Object(i.jsx)(K.a,{item:!0,container:!0,children:Object(i.jsxs)(K.a,{item:!0,container:!0,xs:12,children:[Object(i.jsx)(K.a,{item:!0,xs:12,children:qe.version}),Object(i.jsx)("ul",{children:Be[qe.version].changes.map((function(e){return Object(i.jsx)("li",{children:e},e)}))})]})})]})})}L();var Ye=G();var $e=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(_e.a)("`",(function(){c((function(e){return!!j.debug&&(e||(E().paused=!0),T(),!e)}))})),Object(i.jsxs)(Y.a,{initialEntries:["reincarnating"===E().currentAction?"/reincarnating":"adventuring"===E().currentAction?"/adventuring":"/"],basename:"%PUBLIC_URL%",children:[Object(i.jsxs)(Y.c,{children:[Object(i.jsx)(Y.b,{path:"/",exact:!0,children:Object(i.jsx)(Ge,{})}),Object(i.jsx)(Y.b,{path:"/reincarnating",exact:!0,children:Object(i.jsx)(te,{reincarnate:function(e,t){!function(e,t){var n=C(0),i=b[n.appearance];if(i&&i.traits.forEach((function(e){A.unlockedTraits[e]&&!n.powerLevel.gt(A.unlockedTraits[e])||(A.unlockedTraits[e]=n.powerLevel)})),Object(f.Decimal)(A.highestLevelReached).lt(n.powerLevel)&&(A.highestLevelReached=n.powerLevel),"random"===e){var a=u.difference(Object.keys(b).filter((function(e){return u.get(A,["debug","creatures",e,"enabled"],!0)&&!1!==b[e].enabled})),Object.keys(A.unlockedMonsters).filter((function(e){return A.unlockedMonsters[e]})));e=a[Math.floor(Math.random()*a.length)]}if(Object.keys(n.attributes).forEach((function(e){n.attributes[e]=Object(f.Decimal)(t[e.substring(1)])})),0!==A.reincarnationCount){var c=F(j.mechanics.reincarnation.latentPowerGainOnReincarnate,{player:n});A.characters[0].latentPower=A.characters[0].latentPower.plus(c)}A.characters[0].absorbedPower=Object(f.Decimal)(0),A.characters[0].reincarnate(e,A.startingTraits),A.unlockedMonsters[e]=!0,C(0).traits=Object.keys(A.startingTraits).reduce((function(e,t){return e[t]=A.unlockedTraits[t],e}),{}),b[e].traits.forEach((function(e){C(0).traits[e]=1})),A.currentEncounter=null,A.currentAction="reincarnating",C(0).currentHp=C(0).maximumHp,E().passivePowerIncome=Object(f.Decimal)(0),A.reincarnationCount++,T()}(e,t),A.paused=!1}})}),Object(i.jsx)(Y.b,{path:"/adventuring",exact:!0,children:Object(i.jsx)(Ce,{rng:Ye})})]}),n&&Object(i.jsx)(We,{})]})},Ke=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,744)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),i(e),a(e),c(e),r(e)}))};s.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)($e,{})}),document.getElementById("root")),Ke()}},[[704,1,2]]]);
//# sourceMappingURL=main.fa944660.chunk.js.map